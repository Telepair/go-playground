# 数字雨

[English Version / 英文版本](README.md)

[Wikipedia - Matrix Digital Rain](https://en.wikipedia.org/wiki/Matrix_digital_rain)

一个终端用户界面实现的著名黑客帝国数字雨效果。

## 功能特性

- **黑客帝国风格动画**：字符垂直下落并带有拖尾效果
- **可自定义颜色**：配置雨滴、拖尾和背景颜色
- **可变速度**：调整动画速度和雨滴特性
- **字符集**：默认 base64 字符集或自定义字符
- **双语支持**：界面支持英文和中文
- **交互式控制**：实时暂停、调整参数和重置

## 安装

```bash
cd digital-rain
go build
```

## 使用方法

使用默认设置运行：

```bash
./digital-rain
```

### 命令行选项

- `-drop-color`：雨滴颜色（十六进制格式）（默认："#00FF00"）
- `-trail-color`：拖尾颜色（十六进制格式）（默认："#008800"）
- `-bg-color`：背景颜色（十六进制格式）（默认："#000000"）
- `-charset`：使用的字符集（默认：base64 字符）
- `-min-speed`：最小下落速度（默认：1）
- `-max-speed`：最大下落速度（默认：5）
- `-drop-length`：雨滴长度（默认：10）
- `-lang`：语言（en/cn）（默认："en"）
- `-profile`：启用性能分析和监控
- `-log-file`：用于调试的日志文件路径

### 示例

二进制雨效果：

```bash
./digital-rain -charset '01'
```

深色背景上的白色雨：

```bash
./digital-rain -drop-color '#FFFFFF' -trail-color '#888888'
```

快速长雨滴：

```bash
./digital-rain -max-speed 10 -drop-length 20
```

## 控制键

- **空格/回车**：暂停/继续动画
- **+/-** 或 **↑/↓**：增加/减少动画速度
- **d/D**：增加/减少雨滴长度
- **s/S**：增加/减少最大速度
- **r**：重置动画
- **l**：切换语言（英文/中文）
- **q/Esc/Ctrl+C**：退出

## 实现细节

数字雨效果由多个在屏幕上下落的"雨滴"组成：

1. **雨滴系统**：每列都有一个独立的雨滴，具有自己的速度和长度
2. **拖尾效果**：使用颜色强度映射使字符逐渐淡化
3. **字符变化**：字符在下落时随机变化
4. **生成控制**：前一个雨滴消失后，新雨滴以随机间隔出现

## 性能优化

应用程序针对流畅动画进行了优化：

- 使用字符串构建器进行高效的网格渲染
- 预计算拖尾效果的颜色样式
- 使用互斥锁保护的并发安全操作
- 可配置的刷新率（最小 10 毫秒）

## 测试

运行测试套件：

```bash
go test
```

运行基准测试：

```bash
go test -bench=.
```
